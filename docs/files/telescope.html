<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>LuaDoc</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h1>Modules</h1>
<ul>

	<li>
		<a href="../modules/telescope.html">telescope</a>
	</li>

</ul>



<!-- File list -->

<h1>Files</h1>
<ul>

	<li><strong>telescope.lua</strong></li>
	
</ul>






</div> <!-- id="navigation" -->

<div id="content">

<h1>File <code>telescope.lua</code></h1>


<p>Telescope is a test library for Lua that allows for flexible, declarative tests. For information, please visit the project homepage at: <a href="http://telescope.luaforge.net/">http://telescope.luaforge.net</a>.</p>




<p><small><b>Release:</b> 0.1</small></p>



<h2>Functions</h2>
<table class="function_list">

	<tr>
	<td class="name" nowrap><a href="#error_report">error_report</a>&nbsp;(results)</td>
	<td class="summary">Show stack traces for tests which produced a failure or an error.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#invert_table">invert_table</a>&nbsp;(t)</td>
	<td class="summary">Return a table with table t's values as keys and keys as values.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#load_contexts">load_contexts</a>&nbsp;(path, contexts)</td>
	<td class="summary">Build a contexts table from the test file given in <tt>path</tt>.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#make_assertion">make_assertion</a>&nbsp;(name, message, func)</td>
	<td class="summary">Create a custom assertion.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#run">run</a>&nbsp;(contexts, callbacks)</td>
	<td class="summary">Run all tests.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#summary_report">summary_report</a>&nbsp;(results)</td>
	<td class="summary">Show a one-line report with the status counts.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#test_report">test_report</a>&nbsp;(results)</td>
	<td class="summary">Show a detailed report for each context, with the status of each test.</td>
	</tr>

</table>




<h2>Tables</h2>
<table class="table_list">

	<tr>
	<td class="name" nowrap><a href="#assertions">assertions</a></td>
	<td class="summary">The default assertions.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#context_aliases">context_aliases</a></td>
	<td class="summary">The default names for context blocks.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#status_codes">status_codes</a></td>
	<td class="summary">The status codes that can be returned by an invoked test.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#status_labels">status_labels</a></td>
	<td class="summary">Labels used to show the various <tt>status_codes</tt> as a single character.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#test_aliases">test_aliases</a></td>
	<td class="summary">The default names for test blocks.</td>
	</tr>

</table>



<br/>
<br/>




<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="error_report"></a><strong>error_report</strong>&nbsp;(results)</dt>
<dd>
Show stack traces for tests which produced a failure or an error.


<h3>Parameters</h3>
<ul>
	
	<li>
	  results: 
	</li>
	
</ul>








</dd>




<dt><a name="invert_table"></a><strong>invert_table</strong>&nbsp;(t)</dt>
<dd>
Return a table with table t's values as keys and keys as values.


<h3>Parameters</h3>
<ul>
	
	<li>
	  t: 
	</li>
	
</ul>








</dd>




<dt><a name="load_contexts"></a><strong>load_contexts</strong>&nbsp;(path, contexts)</dt>
<dd>
Build a contexts table from the test file given in <tt>path</tt>. If the optional <tt>contexts</tt> table argument is provided, than the resulting contexts will be added to it. <p> The resulting contexts table has a structure as follows: </p> <code> { 1 = { name = "A context", context = { 1 = { name = "A nested context", context = { 1 = { name = "A test", func = function: 0x143390 } } } } } } </code> <p> In other words, a context table is a list of tables. Each table in the list is an associative array with two fields: "name," and either "context" or "function." The second field is either another context table, or a a function created by a test block. </p>


<h3>Parameters</h3>
<ul>
	
	<li>
	  path: 
	</li>
	
	<li>
	  contexts: 
	</li>
	
</ul>








</dd>




<dt><a name="make_assertion"></a><strong>make_assertion</strong>&nbsp;(name, message, func)</dt>
<dd>
Create a custom assertion. This creates an assertion along with a corresponding negative assertion. It is used internally by telescope to create the default assertions.


<h3>Parameters</h3>
<ul>
	
	<li>
	  name: The base name of the assertion. <p> The name will be used as the basis of the positive and negative assertions; i.e., the name <tt>equal</tt> would be used to create the assertions <tt>assert_equal</tt> and <tt>assert_not_equal</tt>. </p>
	</li>
	
	<li>
	  message: The base message that will be shown. <p> The assertion message is what is shown when the assertion fails.  It will be prefixed with the string in <tt>telescope.assertion_message_prefix</tt>. The variables passed to <tt>telescope.make_assertion</tt> are interpolated in the message string using <tt>string.format</tt>.  When creating the inverse assertion, the message is reused, with <tt>" to be "</tt> replaced by <tt>" not to be "</tt>. Hence a recommended format is something like: <tt>"%s to be similar to %s"</tt>. </p>
	</li>
	
	<li>
	  func: The assertion function itself. <p> The assertion function can have any number of arguments. </p>
	</li>
	
</ul>




<h3>Usage:</h3>
<tt>make_assertion("equal", "%s to be equal to %s", function(a, b) return a == b end)</tt>





<h3>See also:</h3>
<ul>
	
	<li><a href="../files/telescope.html#assertions">
		assertions
	</a>
	
</ul>

</dd>




<dt><a name="run"></a><strong>run</strong>&nbsp;(contexts, callbacks)</dt>
<dd>
Run all tests. This function will exectute each function in the contexts table, and add the following fields to its corresponding table: <ul> <li>status_code - the test status code</li> <li>status_label - the label for the status_code</li> <li>message - a table with an error message and stack trace, if the test failed or produced an error.</li> </ul>


<h3>Parameters</h3>
<ul>
	
	<li>
	  contexts: The contexts created by <tt>load_contexts</tt>.
	</li>
	
	<li>
	  callbacks: A table of callback functions to be invoked before or after various test states. <p> There is a callback for each test <tt>status_code</tt>. Valid callbacks are: </p> <ul> <li>after - will be invoked after each test</li> <li>before - will be invoked before each test</li> <li>err - will be invoked after each test which results in an error</li> <li>fail - will be invoked after each failing test</li> <li>pass - will be invoked after each passing test</li> <li>pending - will be invoked after each pending test</li> <li>unassertive - will be invoked after each test which doesn't assert anything</li> </ul> <p> Callbacks could be used, for example, to drop into a debugger upon a failed expectation or error, for profiling, or updating a GUI progress meter. </p>
	</li>
	
</ul>






<h3>Return value:</h3>
A table with the following fields: <ul> <li>assertions - assertion count</li> <li>errors - error count</li> <li>failures - failure count</li> <li>passes - passed test count</li> <li>pendings - pending count</li> <li>tests - test count</li> <li>unassertive - unassertive test count</li> <li>contexts - the context table passed as an argument to <tt>run</tt>.</li> </ul>



<h3>See also:</h3>
<ul>
	
	<li><a href="../files/telescope.html#load_contexts">
		load_contexts
	</a>
	
	<li><a href="../files/telescope.html#status_codes">
		status_codes
	</a>
	
</ul>

</dd>




<dt><a name="summary_report"></a><strong>summary_report</strong>&nbsp;(results)</dt>
<dd>
Show a one-line report with the status counts. The counts given are: total tests, assertions, passed tests, failed tests, pending tests, and tests which didn't assert anything.


<h3>Parameters</h3>
<ul>
	
	<li>
	  results: 
	</li>
	
</ul>








</dd>




<dt><a name="test_report"></a><strong>test_report</strong>&nbsp;(results)</dt>
<dd>
Show a detailed report for each context, with the status of each test.


<h3>Parameters</h3>
<ul>
	
	<li>
	  results: 
	</li>
	
</ul>








</dd>


</dl>




<h2><a name="tables"></a>Tables</h2>
<dl class="table">

<dt><a name="assertions"></a><strong>assertions</strong></dt>
<dd>The default assertions. These are the assertions built into telescope. You can override them or create your own custom assertions using <tt>make_assertion</tt>. <ul> <tt><li>assert_nil(a)</tt> - true if a is nil</li> <tt><li>assert_blank(a)</tt> - true if a is nil, or the empty string</li> <tt><li>assert_empty(a)</tt> - true if a is an empty table</li> <tt><li>assert_equal(a, b)</tt> - true if a == b</li> <tt><li>assert_match(a, b)</tt> - true if b is a string that matches pattern a</li> <tt><li>assert_greater_than(a, b)</tt> - true if a > b</li> <tt><li>assert_less_than(a, b)</tt> - true if a < b</li> <tt><li>assert_gte(a, b)</tt> - true if a >= b</li> <tt><li>assert_lte(a, b)</tt> - true if a <= b</li> <tt><li>assert_not_nil(a)</tt> - true if a is not nil</li> <tt><li>assert_not_blank(a)</tt>  - true if a is not nil and a is not the empty string</li> <tt><li>assert_not_empty(a)</tt> - true if a is a table, and a is not empty</li> <tt><li>assert_not_equal(a, b)</tt> - true if a ~= b</li> <tt><li>assert_not_match(a, b)</tt> - true if the string b does not match the pattern a</li> <tt><li>assert_not_greater_than(a, b)</tt> - true if not (a > b)</li> <tt><li>assert_not_less_than(a, b)</tt> - true if not (a < b)</li> <tt><li>assert_not_gte(a, b)</tt> - true if not (a >= b)</li> <tt><li>assert_not_lte(a, b)</tt> - true if not (a <= b)</li> </ul>



</dd>


<dt><a name="context_aliases"></a><strong>context_aliases</strong></dt>
<dd>The default names for context blocks. It defaults to "context", "spec" and "describe." You can override this table to create your own custom name for contexts.



</dd>


<dt><a name="status_codes"></a><strong>status_codes</strong></dt>
<dd>The status codes that can be returned by an invoked test. These should not be overidden.


<em>Fields</em>
<ul>
	
	<li>
	  err: - This is returned when an invoked test results in an error rather than a passed or failed assertion.
	</li>
	
	<li>
	  fail: - This is returned when an invoked test contains one or more failing assertions.
	</li>
	
	<li>
	  pass: - This is returned when all of a test's assertions pass.
	</li>
	
	<li>
	  pending: - This is returned when a test does not have a corresponding function.
	</li>
	
	<li>
	  unassertive: - This is returned when an invoked test does not produce errors, but does not contain any assertions.
	</li>
	
</ul>


</dd>


<dt><a name="status_labels"></a><strong>status_labels</strong></dt>
<dd>Labels used to show the various <tt>status_codes</tt> as a single character. These can be overidden if you wish.


<em>Fields</em>
<ul>
	
	<li>
	  status_codes.err: 'E'
	</li>
	
	<li>
	  status_codes.fail: 'F'
	</li>
	
	<li>
	  status_codes.pass: 'P'
	</li>
	
	<li>
	  status_codes.pending: '?'
	</li>
	
	<li>
	  status_codes.unassertive: 'U'
	</li>
	
</ul>


</dd>


<dt><a name="test_aliases"></a><strong>test_aliases</strong></dt>
<dd>The default names for test blocks. It defaults to "test," "it", "expect" and "should." You can override this table to create your own custom name for tests.



</dd>


</dl>




</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
